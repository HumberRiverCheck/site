<!DOCTYPE html>
<html lang="en">
	
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title> Humber River Data Visualization </title>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Playwrite+DE+Grund:wght@100..400&display=swap" rel="stylesheet">

        <!-- Stylesheet -->
        <link rel="stylesheet" href="style.css">
        
    </head>

    <body class="background_image">
    <div class="background_container">
    <img src="IMG_5593.jpeg" alt="Background Image" class="background_image">
    <div class="overlay_river"></div>
        <div class="outer">
            <div class="slider_info_wrap">
                <!-- Description for worms slider -->
                <div class="worms_info">
                    <p> Percentage of the total benthic macro-invertebrate sample consisting of Flatworms, Roundworms, and Aquatic Earth Worms (Oligochatea, Nematoda or Tubellaria) </p>
                </div>

                <!-- Display for midges slider -->
                <div class="midges_info">
                    <p> Percentage of the total benthic macro-invertebrate sample consisting of Midges (Chironomidae) </p>
                </div>

                <!-- Display for sowbugs slider -->
                <div class="sowbugs_info">
                    <p> Percentage of the total benthic macro-invertebrate sample consisting of Aquatic Sow Bugs (Isopoda) </p>
                </div>

                <!-- Display for snails slider -->
                <div class="snails_info">
                    <p> Percentage of the total benthic macro-invertebrate sample consisting of Snails (Gastropoda) </p>
                </div>

                <!-- Display for species slider -->
                <div class="species_info">
                    <p> Number of taxonomic groups found in this sample. Some of these groups include multiple closely related species </p>
                </div>

                <!-- Display for dominant species slider -->
                <div class="d_species_info">
                    <p> Percentage of the total benthic macro-invertebrate sample belonging to the most common taxonomic group </p>
                </div>

                <!-- Display for ept slider -->
                <div class="ept_info">
                    <p> Percentage of the total benthic macro-invertebrate sample consisting of Mayflies, Stoneflies, and Caddisflies (Ephemeroptera, Plecoptera, Trichoptera) </p>
                </div>
                
                <!-- Display for flies slider -->
                <div class="flies_info">
                    <p> Percentage of the total benthic macro-invertebrate sample consisting of True Flies, which includes Blackflies, Craneflies, Mosquitoes, Horse & Deerflies, and Midges (Diptera: Simuliidae, Tipulidae, Culicidae, Tabanidae, Chironomidae) </p>
                </div>
                
                <!-- Display for insects slider -->
                <div class="insects_info">
                    <p>  Percentage of the total benthic macro-invertebrate sample consisting of insects. This includes Dragonflies, Beetles, Mayflies, True Bugs, Fishflies & Alderflies, Stoneflies, Caddisflies, Damselflies, and all True Flies, which includes Blackflies, Craneflies, Mosquitoes, Horse & Deerflies, and Midges, (Anisoptera, Coleoptera, Ephemeroptera, Hemiptera, Megaloptera, Plecoptera, Tricoptera, Zygoptera, Diptera: Simuliidae, Tipulidae, Culicidae, Tabanidae, Chironomidae) </p>
                </div>

                <!-- Display for hbi slider -->
                <div class="hbi_info">
                    <p> Hilsenhoff Biotic Index. This is calculated by taking the sum of the product of the count of each group times an established tolerance rating for each group SUM (COUNT x TOL) </p>
                </div>
                
            </div>

            <div class="slider_column">
                <!-- Sliders (Inverted container, so top slider starts at the bottom.) -->

                    <!-- TER Rating -->
                    <div>
                        <h4 class="ter_display" > Total Enviromental Rating (TER): <var class="ter_display" id="ter_value">0</var> % </h4>
                    </div>

                    <!-- HBI INDEX -->
                    <div class="slider_container">
                        <h4 class="slider_name"> HBI Index: <var class="slider_value_display" id="hbi_value">0</var> </h4>
                        <input type="range" min="1" max="8" value="0" class="slider" id="slider_hbi">
                    </div>

                    <!-- INSECTS -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Insects: <var class="slider_value_display" id="insects_value">0</var> %  </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_insects">
                    </div>

                    <!-- FLIES -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Flies: <var class="slider_value_display" id="flies_value">0</var> %  </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_flies">
                    </div>

                    <!-- EPT INDEX -->
                    <div class="slider_container">
                        <h4 class="slider_name"> EPT Index: <var class="slider_value_display" id="ept_value">0</var> % </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_ept">
                    </div>

                    <!-- DOMINANT SPECIES -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Dominant Species: <var class="slider_value_display" id="d_species_value">0</var> % </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_d_species">
                    </div>

                    <!-- SPECIES -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Species: <var class="slider_value_display" id="species_value">0</var> </h4>
                        <input type="range" min="0" max="28" value="0" class="slider" id="slider_species">
                    </div>

                    <!-- SNAILS -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Snails: <var class="slider_value_display" id="snails_value">0</var> % </h4>
                        <input type="range" min="0" max="500" value="0" class="slider" id="slider_snails">
                    </div>

                    <!-- SOWBUGS -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Sowbugs: <var class="slider_value_display" id="sowbugs_value">0</var> % </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_sowbugs">
                    </div>

                    <!-- MIDGES -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Midges: <var class="slider_value_display" id="midges_value">0</var> % </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_midges">
                    </div>

                    <!-- WORMS -->
                    <div class="slider_container">
                        <h4 class="slider_name"> Worms: <var class="slider_value_display" id="worms_value">0</var> % </h4>
                        <input type="range" min="0" max="100" value="0" class="slider" id="slider_worms">
                    </div>

            </div>

        </div>
    </div>
    </body>



    
<script>
    /* Slider color changer for sliders with percentages */
    class SliderColorController {
        constructor(sliderId, max_1, min_2, max_2, min_3) {
            this.slider = document.getElementById(sliderId);
            this.maxValue = this.slider.max;

            this.max_1 = max_1;
            this.min_2 = min_2;
            this.max_2 = max_2;
            this.min_3 = min_3;
            
            this.slider.addEventListener('input', () => {
                this.updateSliderColor();
            });
        }

        // Method to update slider color based on its value
        updateSliderColor() {
            const currentValue = this.slider.value;

            // Add or remove the 'slider-green' class based on the value
            if (currentValue <= this.maxValue * this.max_1) {
                this.slider.classList.add('slider-green');
            } else {
                this.slider.classList.remove('slider-green');
            }

            // Add or remove the 'slider-yellow' class based on the value
            if (currentValue >= this.maxValue * this.min_2 && currentValue <= this.maxValue * this.max_2) {
                this.slider.classList.add('slider-yellow');
            } else {
                this.slider.classList.remove('slider-yellow');
            }

            // Add or remove the 'slider-red' class based on the value
            if (currentValue >= this.maxValue * this.min_3) {
                this.slider.classList.add('slider-red');
            } else {
                this.slider.classList.remove('slider-red');
            }
        }
    }

    /* Value display */
    class ValueDisplayPercentage {
        constructor(sliderId, varId) {
            // Select the slider and <var> elements by their IDs
            this.slider = document.getElementById(sliderId);
            this.varElement = document.querySelector(`#${varId}`);

            this.slider.addEventListener('input', () => {
                this.updateContent();
            });
        }

        updateContent() {
            if (this.varElement) {
                const currentValue = this.slider.value;
                const maxValue = this.slider.max;
                const valPercentage = currentValue / maxValue * 100;
                const valRound = Math.round(valPercentage);
                this.varElement.textContent = valRound;

            } else {
                console.error('Var element not found');
            }
        }

    }

    class ValueDisplayNumbered {
        constructor(sliderId, varId) {
            // Select the slider and <var> elements by their IDs
            this.slider = document.getElementById(sliderId);
            this.varElement = document.querySelector(`#${varId}`);

            this.slider.addEventListener('input', () => {
                this.updateContent();
            });
        }

        updateContent() {
            if (this.varElement) {
                //const currentValue = this.slider.value;
                this.varElement.textContent = this.slider.value;

            } else {
                console.error('Var element not found');
            }
        }

    }
    
    /* Visibility display */
    class InfoVisibility {
        constructor(slider_name, box_element) {
            this.slider = document.getElementById(slider_name);
            this.boxElement = document.querySelector(box_element);

            this.init();
        }

        init() {
            // Show info box when slider is moved
            this.slider.addEventListener('input', () => {
                this.boxElement.style.display = 'flex';
            });

            // Show info box when mouse is held
            this.slider.addEventListener('mousedown', () => {
                this.boxElement.style.display = 'none';
            });

            // Hide info box when mouse is released
            this.slider.addEventListener('mouseup', () => {
                this.boxElement.style.display = 'none';
            });
        }
        
    }

    /* Get TER Rating for linear sliders*/
    class GetSliderRating {
        constructor(sliderId, max_1, min_2, max_2, min_3) {
            this.slider = document.getElementById(sliderId);
            this.maxValue = this.slider.max || 100; // Fallback to 100 if max isn't set
            
            this.max_1 = max_1;
            this.min_2 = min_2;
            this.max_2 = max_2;
            this.min_3 = min_3;
            this.color = null;
            this.rating = null;

            // Call returnColor initially to set the color
            this.returnColor();
            this.returnValue();

            // Add an event listener to update the color and rating when the slider changes
            this.slider.addEventListener('input', () => {
            this.returnColor();
            this.returnValue();
            });
        }

        returnColor() {
            if (this.slider.value <= this.maxValue * this.max_1) {
            this.color = 'green';
            } else if (
            this.slider.value >= this.maxValue * this.min_2 &&
            this.slider.value <= this.maxValue * this.max_2
            ) {
            this.color = 'yellow';
            } else if (this.slider.value >= this.maxValue * this.min_3) {
            this.color = 'red';
            } else {
            this.color = null;
            }

            console.log(`Current color: ${this.color}`);
        }

        returnValue() {
            if (this.color === 'green') {
            this.rating = 0;
            } else if (this.color === 'yellow') {
            this.rating = 3;
            } else if (this.color === 'red') {
            this.rating = 5;
            } else {
            this.rating = null;
            }

            console.log(`Current rating: ${this.rating}`);
            return this.rating;
        }
    }

    /* Get TER Rating for species sliders*/
    class GetSpeciesRating {
        constructor(sliderId, max_1, min_2, max_2, min_3) {
            this.slider = document.getElementById(sliderId);
            
            this.max_1 = max_1;
            this.min_2 = min_2;
            this.max_2 = max_2;
            this.min_3 = min_3;
            this.color = null;
            this.rating = null;

            // Call returnColor initially to set the color
            this.returnColor();
            this.returnValue();

            // Add an event listener to update the color and rating when the slider changes
            this.slider.addEventListener('input', () => {
            this.returnColor();
            this.returnValue();
            });
        }

        returnColor() {
            if (this.slider.value <= this.max_1) {
            this.color = 'red';
            } else if (
            this.slider.value >= this.min_2 &&
            this.slider.value <= this.max_2
            ) {
            this.color = 'yellow';
            } else if (this.slider.value >= this.min_3) {
            this.color = 'green';
            } else {
            this.color = null;
            }

            console.log(`Current color: ${this.color}`);
        }

        returnValue() {
            if (this.color === 'green') {
            this.rating = 0;
            } else if (this.color === 'yellow') {
            this.rating = 3;
            } else if (this.color === 'red') {
            this.rating = 5;
            } else {
            this.rating = null;
            }

            console.log(`Current rating: ${this.rating}`);
            return this.rating;
        }
    }




 /*
    document.getElementById('slider_worms').addEventListener('input', function () {
        const slider = this;
        const maxValue = slider.max;
        const currentValue = slider.value;

        if (currentValue <= maxValue * 0.10) {
            slider.classList.add('slider-green');
        } else {
            slider.classList.remove('slider-green');
        }

        if ((currentValue >= maxValue * 0.11) && (currentValue <= maxValue * 0.30)) {
            slider.classList.add('slider-yellow');
        } else {
            slider.classList.remove('slider-yellow');
        }
 
        if (currentValue >= maxValue * 0.31) {
            slider.classList.add('slider-red');
        } else {
            slider.classList.remove('slider-red');
        }
        
    });
*/

    /* Slider Color Display off of Slider Value */
    // WORMS
    new SliderColorController('slider_worms', 0.10, 0.11, 0.30, 0.31);

    // MIDGES
    new SliderColorController('slider_midges', 0.10, 0.11, 0.40, 0.41);

    // SOWBUGS
    new SliderColorController('slider_sowbugs', 0.00, 0.01, 0.05, 0.06);

    // SNAILS
    new SliderColorController('slider_snails', 0.00, 0.01, 0.10, 0.11);

    // SPECIES
    document.getElementById('slider_species').addEventListener('input', function () {
        const slider = this;
        const currentValue = slider.value;

        if (currentValue <= 10) {
            slider.classList.add('slider-red');
        } else {
            slider.classList.remove('slider-red');
        }

        if (currentValue == 11) {
            slider.classList.add('slider-yellow');
        } else {
            slider.classList.remove('slider-yellow');
        }
 
        if (currentValue >= 12) {
            slider.classList.add('slider-green');
        } else {
            slider.classList.remove('slider-green');
        }
        
    });

    // DOMINANT SPECIES
    new SliderColorController('slider_d_species', 0.40, 0.41, 0.45, 0.46);


    // EPT INDEX SPECIES
    document.getElementById('slider_ept').addEventListener('input', function () {
        const slider = this;
        const maxValue = slider.max;
        const currentValue = slider.value;

        if (currentValue <= maxValue * 0.05) {
            slider.classList.add('slider-red');
        } else {
            slider.classList.remove('slider-red');
        }

        if ((currentValue >= maxValue * 0.06) && (currentValue <= maxValue * 0.10)) {
            slider.classList.add('slider-yellow');
        } else {
            slider.classList.remove('slider-yellow');
        }
 
        if (currentValue >= maxValue * 0.11) {
            slider.classList.add('slider-green');
        } else {
            slider.classList.remove('slider-green');
        }
        
    });

    // FLIES (NON-LINEAR)
    document.getElementById('slider_flies').addEventListener('input', function () {
        const slider = this;
        const maxValue = slider.max;
        const currentValue = slider.value;

        /* Red */
        if (currentValue <= maxValue * 0.15) {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.add('slider-red');
        } 
        
        /* Yellow */
        else if ((currentValue >= maxValue * 0.16) && (currentValue <= maxValue * 0.20)) {
            slider.classList.remove('slider-green');
            slider.classList.add('slider-yellow');
            slider.classList.remove('slider-red');
        }

        /* Green */
        else if ((currentValue >= maxValue * 0.21) && (currentValue <= maxValue * 0.45)) {
            slider.classList.add('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.remove('slider-red');
        }
        
        /* Yellow */
        else if ((currentValue >= maxValue * 0.46) && (currentValue <= maxValue * 0.50)) {
            slider.classList.remove('slider-green');
            slider.classList.add('slider-yellow');
            slider.classList.remove('slider-red');
        }

        /* Red */
        else if (currentValue >= maxValue * 0.51) {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.add('slider-red');
        }
        
        else {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.remove('slider-red');
        }

    });

    // INSECTS
    document.getElementById('slider_insects').addEventListener('input', function () {
        const slider = this;
        const maxValue = slider.max;
        const currentValue = slider.value;

        /* Red */
        if (currentValue <= maxValue * 0.40) {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.add('slider-red');
        } 
        
        /* Yellow */
        else if ((currentValue >= maxValue * 0.41) && (currentValue <= maxValue * 0.50)) {
            slider.classList.remove('slider-green');
            slider.classList.add('slider-yellow');
            slider.classList.remove('slider-red');
        }

        /* Red */
        else if ((currentValue >= maxValue * 0.51) && (currentValue <= maxValue * 0.80)) {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.add('slider-red');
        }
        
        /* Yellow */
        else if ((currentValue >= maxValue * 0.81) && (currentValue <= maxValue * 0.90)) {
            slider.classList.remove('slider-green');
            slider.classList.add('slider-yellow');
            slider.classList.remove('slider-red');
        }

        /* Red */
        else if (currentValue >= maxValue * 0.91) {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.add('slider-red');
        }
        
        else {
            slider.classList.remove('slider-green');
            slider.classList.remove('slider-yellow');
            slider.classList.remove('slider-red');
        }

    });


    // HBI INDEX (NUMBERED) 
    document.getElementById('slider_hbi').addEventListener('input', function () {
        const slider = this;
        const currentValue = slider.value;

        if (currentValue <= 5) {
            slider.classList.add('slider-green');
        } else {
            slider.classList.remove('slider-green');
        }

        if (currentValue >= 6 && currentValue <= 7) {
            slider.classList.add('slider-yellow');
        } else {
            slider.classList.remove('slider-yellow');
        }
 
        if (currentValue == 8) {
            slider.classList.add('slider-red');
        } else {
            slider.classList.remove('slider-red');
        }
        
    });

    /* Value Display */
    // Worms
    new ValueDisplayPercentage('slider_worms', 'worms_value');

    // Midges
    new ValueDisplayPercentage('slider_midges', 'midges_value');

    // Sowbugs
    new ValueDisplayPercentage('slider_sowbugs', 'sowbugs_value');

    // Snails
    new ValueDisplayPercentage('slider_snails', 'snails_value');

    // Species
    new ValueDisplayNumbered('slider_species', 'species_value');

    // Dominant Species
    new ValueDisplayPercentage('slider_d_species', 'd_species_value');

    // EPT Index
    new ValueDisplayPercentage('slider_ept', 'ept_value');

    // Flies
    new ValueDisplayPercentage('slider_flies', 'flies_value');

    // Insects
    new ValueDisplayPercentage('slider_insects', 'insects_value');

    // HBI Index
    new ValueDisplayNumbered('slider_hbi', 'hbi_value');



    /* Description Display */
    // Worms
    new InfoVisibility('slider_worms', '.worms_info');

    // Midges
    new InfoVisibility('slider_midges', '.midges_info');

    // Sowbugs
    new InfoVisibility('slider_sowbugs', '.sowbugs_info');

    // Snails
    new InfoVisibility('slider_snails', '.snails_info');

    // Species
    new InfoVisibility('slider_species', '.species_info');

    // Dominant Species
    new InfoVisibility('slider_d_species', '.d_species_info');

    // EPT Index
    new InfoVisibility('slider_ept', '.ept_info');

    // Flies
    new InfoVisibility('slider_flies', '.flies_info');

    // Insects
    new InfoVisibility('slider_insects', '.insects_info');

    // HBI Index
    new InfoVisibility('slider_hbi', '.hbi_info');


    /* TER Rating */
    const sliders = document.querySelectorAll('input[type="range"]');
    const resultDisplay = document.getElementById('ter_value');
    const overlayRiver = document.querySelector('.overlay_river');

    function setBackgroundColor(totalRating) {
        let hue;

        // Set hue based on totalRating value
        if (totalRating <= 19) {
            hue = 120; // Green

        } else if (totalRating >= 20 && totalRating <= 24) {
            hue = 80; // Yellow-Green

        } else if (totalRating >= 25 && totalRating <= 29){
            hue = 60; // Yellow

        } else if (totalRating >= 30 && totalRating <= 34) {
            hue = 30; // Orange

        } else if (totalRating >= 35 && totalRating <= 50) {
            hue = 0; // Red
        } else {
            hue = 180;
        }

        overlayRiver.style.backgroundColor = `hsl(${hue}, 100%, 50%)`;
    }

    function calculateTotalRating() {
        let totalRating = 0;

        /* Get rating for linear sliders */
        const worms_rating = new GetSliderRating('slider_worms', 0.10, 0.11, 0.30, 0.31);
        const midges_rating = new GetSliderRating('slider_midges', 0.10, 0.11, 0.40, 0.41);
        const sowbugs_rating = new GetSliderRating('slider_sowbugs', 0.00, 0.01, 0.05, 0.06);
        const snails_rating = new GetSliderRating('slider_snails', 0.00, 0.01, 0.10, 0.11);
        const d_species_rating = new GetSliderRating('slider_d_species', 0.40, 0.41, 0.45, 0.46);

        /* Get rating for non-linear sliders */

        /* Get ratings for everything else */
        
        // Species slider
        const species_rating = new GetSpeciesRating('slider_species', 10, 11, 11, 12);
        


        totalRating = worms_rating.rating + midges_rating.rating + sowbugs_rating.rating + snails_rating.rating + d_species_rating.rating + species_rating.rating;
        
        resultDisplay.textContent = `${totalRating}`;

        // Set background color based on totalRating
        setBackgroundColor(totalRating);

    }

    sliders.forEach(slider => {
        slider.addEventListener('input', calculateTotalRating);
    });

    calculateTotalRating();

</script>
</html>
